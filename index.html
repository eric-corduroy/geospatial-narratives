<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zeitungsartikel-Archiv</title>
    <style>
        :root {
            --primary-color: #334155;
            --secondary-color: #94a3b8;
            --accent-color: #0ea5e9;
            --background-color: #f8fafc;
            --text-color: #1e293b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text-color);
            background-color: var(--background-color);
            line-height: 1.6;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 0;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        nav a:hover {
            color: var(--accent-color);
        }

        section {
            padding: 2rem 0;
        }

        h1, h2, h3 {
            color: var(--primary-color);
        }

        .filter-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .filter-group select, .filter-group input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--secondary-color);
            border-radius: 4px;
        }

        select[multiple] {
            height: 100px;
        }

        .filters {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--secondary-color);
        }

        th {
            background-color: var(--primary-color);
            color: white;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <h1>Zeitungsartikel-Archiv</h1>
        </nav>
    </header>

    <main class="container">
        <section id="archive">
            <h2>Archiv der Artikel</h2>
            <div class="filters">
                <div class="filter-group">
                    <label for="year-range">Zeitraum (Jahr):</label>
                    <input type="range" id="year-range" min="2000" max="2030" step="1" value="2030" />
                    <span id="year-range-value">2000 – 2030</span>
                </div>

                <div class="filter-group">
                    <label for="outlet-filter">Medium:</label>
                    <select id="outlet-filter" multiple></select>
                </div>

                <div class="filter-group">
                    <label for="country-filter">Land:</label>
                    <select id="country-filter" multiple></select>
                </div>

                <div class="filter-group">
                    <label for="type-filter">Typ:</label>
                    <select id="type-filter" multiple></select>
                </div>

                <div class="filter-group">
                    <label for="category-filter">Kategorie:</label>
                    <select id="category-filter" multiple></select>
                </div>

                <div class="filter-group">
                    <label for="search">Suche:</label>
                    <input type="text" id="search" placeholder="Titel oder Autor...">
                </div>

                <div class="filter-group">
                    <label>&nbsp;</label>
                    <button class="btn" onclick="resetFilters()">Filter zurücksetzen</button>
                </div>
            </div>

            <div class="table-container">
                <table id="articles-table">
                    <thead>
                        <tr>
                            <th>Datum</th>
                            <th>Titel</th>
                            <th>Medium</th>
                            <th>Land</th>
                            <th>Typ</th>
                            <th>Kategorie</th>
                            <th>Autoren</th>
                            <th>Tags</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </section>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script>
        let articlesData = [];
        let filters = {
            yearRange: [2000, 2030],
            outlets: [],
            countries: [],
            types: [],
            categories: [],
            search: ''
        };

        document.addEventListener('DOMContentLoaded', () => {
            Papa.parse('archive.csv', {
                download: true,
                header: true,
                skipEmptyLines: true,
                complete: results => {
                    articlesData = results.data;
                    populateFilters();
                    renderArticlesTable();
                }
            });

            document.getElementById('year-range').addEventListener('input', function () {
                const min = parseInt(this.min);
                const max = parseInt(this.value);
                filters.yearRange = [min, max];
                document.getElementById('year-range-value').textContent = `${min} – ${max}`;
                renderArticlesTable();
            });

            ['outlet-filter', 'country-filter', 'type-filter', 'category-filter'].forEach(id => {
                document.getElementById(id).addEventListener('change', function () {
                    filters[id.split('-')[0] + 's'] = Array.from(this.selectedOptions).map(o => o.value);
                    renderArticlesTable();
                });
            });

            document.getElementById('search').addEventListener('input', function () {
                filters.search = this.value.toLowerCase();
                renderArticlesTable();
            });
        });

        function populateFilters() {
            const sets = {
                outlet: new Set(),
                country: new Set(),
                type: new Set(),
                category: new Set()
            };

            articlesData.forEach(a => {
                sets.outlet.add(a.outlet);
                sets.country.add(a.country);
                sets.type.add(a.type);
                sets.category.add(a.category);
            });

            for (const [key, values] of Object.entries(sets)) {
                const select = document.getElementById(`${key}-filter`);
                values.forEach(val => {
                    const opt = document.createElement('option');
                    opt.value = val;
                    opt.textContent = val;
                    select.appendChild(opt);
                });
            }
        }

        function renderArticlesTable() {
            const tbody = document.querySelector('#articles-table tbody');
            tbody.innerHTML = '';
            const filtered = articlesData.filter(article => {
                const year = new Date(article.date).getFullYear();
                return (
                    year >= filters.yearRange[0] && year <= filters.yearRange[1] &&
                    (!filters.outlets.length || filters.outlets.includes(article.outlet)) &&
                    (!filters.countries.length || filters.countries.includes(article.country)) &&
                    (!filters.types.length || filters.types.includes(article.type)) &&
                    (!filters.categories.length || filters.categories.includes(article.category)) &&
                    (!filters.search || article.title.toLowerCase().includes(filters.search) || article.authors.toLowerCase().includes(filters.search))
                );
            });

            if (filtered.length === 0) {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.colSpan = 8;
                cell.textContent = 'Keine Artikel gefunden.';
                row.appendChild(cell);
                tbody.appendChild(row);
            } else {
                filtered.forEach(a => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${a.date}</td>
                        <td><a href="${a.link}" target="_blank">${a.title}</a></td>
                        <td>${a.outlet}</td>
                        <td>${a.country}</td>
                        <td>${a.type}</td>
                        <td>${a.category}</td>
                        <td>${a.authors}</td>
                        <td>${a.tags}</td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        function resetFilters() {
            filters = {
                yearRange: [2000, 2030],
                outlets: [],
                countries: [],
                types: [],
                categories: [],
                search: ''
            };
            document.getElementById('year-range').value = 2030;
            document.getElementById('year-range-value').textContent = '2000 – 2030';
            ['outlet-filter', 'country-filter', 'type-filter', 'category-filter'].forEach(id => {
                const element = document.getElementById(id);
                Array.from(element.options).forEach(opt => opt.selected = false);
            });
            document.getElementById('search').value = '';
            renderArticlesTable();
        }
    </script>
</body>
</html>
